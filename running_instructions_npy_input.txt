docker run -it --gpus all --rm --shm-size 8g \
-v /home/p102329/thesis/mount_location/deepECG/full_tvt_dataset_no_leakage_converted_for_DeepECG_finetune:/app/data/data_location:ro \
-v /home/p102329/thesis/mount_location/deepECG/full_tvt_dataset_no_leakage_converted_for_DeepECG_finetune:/home/p102329/thesis/mount_location/deepECG/full_tvt_dataset_no_leakage_converted_for_DeepECG_finetune:ro \
-v ./weights/:/app/weights/:ro \
-v ./output_weights/:/app/output_weights/ \
-v ./fairseq-signals/examples/w2v_cmsc/config/finetuning/ecg_transformer/diagnosis.yaml:/app/fairseq-signals/examples/w2v_cmsc/config/finetuning/ecg_transformer/diagnosis.yaml \
deepecg-docker:latest \
/bin/bash

sudo docker run -it --gpus all --rm --shm-size 8g \
  -v /home/p102329/thesis/dummy_data:/app/data/data_location:ro \
  -v /home/p102329/thesis/dummy_data:/home/p102329/thesis/dummy_data:ro \
  -v ./weights/:/app/weights/:ro \
  -v ./output_weights/:/app/output_weights/ \
  -v /home/p102329/thesis/ECG-algos/DeepECG_Docker/fairseq-signals/examples/w2v_cmsc/config/finetuning/ecg_transformer/diagnosis.yaml:/app/fairseq-signals/examples/w2v_cmsc/config/finetuning/ecg_transformer/diagnosis.yaml \
  deepecg-docker:latest /bin/bash


POS_WEIGHT=$(cat /app/data/data_location/labels/pos_weight.txt)
export WANDB_API_KEY=
export WANDB_NAME=initial_test_run


CUDA_VISIBLE_DEVICES=0 fairseq-hydra-train \
    task.data=/app/data/data_location/manifests/af_detection/ \
    model.model_path=/app/weights/base_ssl.pt \
    model.num_labels=1 \
    criterion._name=binary_cross_entropy_with_logits \
    +criterion.pos_weight=$POS_WEIGHT \
    checkpoint.save_dir=/app/output_weights \
    --config-dir /app/fairseq-signals/examples/w2v_cmsc/config/finetuning/ecg_transformer \
    --config-name diagnosis


Three changes only:

Add			+task.npy_dataset=true
Remove		+task.label_file=... — labels are now embedded inside each split's .tsv manifest via y_path:
Update		task.data= to point to the new manifest directory

diagnosis.yaml needs no changes — +task.npy_dataset=true on the CLI overrides the default